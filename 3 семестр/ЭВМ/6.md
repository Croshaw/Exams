[[ЭВМ|<==]]
# Схема работы процессора при выполнении машинной команды
Перед запуском программы на выполнение операционная система автоматически записывает в регистр **CS** адрес сегмента кода, который, содержит код выполняющейся программы. Допустим, что операционная система занесла в регистр **CS** код $1000_{16}$. Первые $256_{10}$ байтов сегмента кода операционная система всегда занимает вспомогательной информацией. Этот участок памяти принято называть **префиксом программного сегмента**, часто встречается также его обозначение PSP (от program segment prefix). Поэтому первый байт программы всегда имеет внутрисегментное смещение $0100_{16} = 256_{10}$ Как известно, для задания адресов в сегменте кода используется пара регистров **CS:IP**. Следовательно, операционная система перед началом выполнения программы должна записать в регистр **IP** код $0100_{16}$.
## Первый этап
Указатель из пары регистров **CS:IP** определяет адрес, который всегда рассматривается процессором как адрес первого байта текущей команды выполняемой программы. В момент запуска программы этот указатель, очевидно, представляет адрес её первой команды. Он выбирается из пары **CS:IP**, выставляется на адресную шину и передается в оперативную память.
## Второй этап
На втором этапе работы процессора содержимое поля, начинающегося с полученного оперативной памятью адреса, передается по шине данных в устройство управления процессора. Поскольку это содержимое рассматривается процессором как код машинной команды, возникает вопрос: сколько байтов поля должно быть передано в устройство управления? Мы знаем, что в системе команд процессора i8086 машинная команда может иметь длину от 1 до 5 байтов. Поэтому в устройство управления передается последовательность не менее чем из 5 байтов. Код из первого байта сравнивается с возможными значениями байта префикса замены сегмента. Если этот код не является префиксом, он считается байтом команды, в котором находится код операции и по которому определяется ее общая длина. В противном случае информация о длине команды выбирается из следующего байта. Затем из переданной последовательности для анализа отбирается только необходимое количество байтов, соответствующее длине команды. Следует обратить внимание на то, что байты кода машинной команды передаются в устройство управления в том же порядке, в котором они находятся в оперативной памяти. *Обратный порядок записи на коды машинных команд не распространяется*. Сфера действия обратного порядка записи это коды данных, над которыми требуется выполнять арифметические операции, коды чисел в форматах с фиксированной или плавающей точкой, коды, используемые для формирования адресов, и т. д. 
## Третий этап
На третьем этапе устройство управления выполняет описанный ранее анализ, определяет длину команды, выделяет из переданной последовательности байтов код команды, а затем увеличивает содержимое регистра **IP** на ее длину, после чего в регистре **IP** оказывается адрес (точнее, внутрисегментное смещение) для следующей команды программы.
## Четврёртый этап
Четвёртый этап выполнения команды. Устройство управления дешифрует команду, выделяя из ее кода все элементы, определяющие выполняемое действие, длину и адреса операндов. Затем в арифметико-логическое устройство(АЛУ) передается информация об операции, которую необходимо выполнить, и по заданным в команде адресам запрашиваются операнды, которые также передаются в АЛУ. Если операнд команды находится в регистре процессора, то значительно упрощает ее выполнение. Если операнд находится в поле оперативной памяти, то устройство управления сначала передает на шину адрес операнда, затем оперативная память по шине данных возвращает в АЛУ код запрошенного операнда. Очевидно, что эти дополнительные действия значительно снижают скорость выполнения команды по сравнению с вариантом, когда операнд находится в регистре процессора. Поэтому следует *всегда, когда это возможно, использовать регистровую или непосредственную адресацию* и как можно реже обращаться за операндами в ОП.
## Пятый этап
На пятом этапе арифметико-логическое устройство выполняет заданное в команде действие. 
## Шестой этап
И на последнем, шестом этапе организуется определенная в команде пересылка результата и формируется соответствующее ему содержимое регистра флажков.